---
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
---

install.packages("tinytex")
tinytex::install_tinytex()

---
 
#### Trabajo Final de Coputación I
#### Nombres y apellidos: Gabriel Di Buongrazio, Andrés Moncada

# "Análisis de la relación entre estadísticas de equipos de la NBA con más y menos victorias durante períodos de nueve años comprendido entre 1996 y 2023."

---
### Introducción
  
* En este informe, analizaremos si existe una relación significativa entre las estadísticas de los equipos de la NBA con más victorias y aquellos con menos victorias durante períodos de nueve años comprendidos entre 1996 y 2023. Para lograrlo, seguiremos los siguientes pasos:
  
### Cálculo del promedio de victorias:
  * Calcularemos el promedio de victorias de cada equipo en los tres periodos de nueve años mencionados.
* Compararemos los valores máximos y mínimos para identificar los equipos con más y menos victorias, respectivamente.

### Análisis de la relación defensa-victorias:
* Investigaremos la relación entre las victorias y las estadísticas defensiva de los dos equipos. Representaremos esta relación mediante un gráfico de dispersión.

### Análisis de la relación estadísticas ofensivas-victorias:
* Estudiaremos la relación entre las victorias y las estadísticas ofensivas de los equipos dos equipos. Utilizaremos un gráfico de dispersión para visualizar esta relación.

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(gridExtra)
library(knitr)
library(dplyr)
library(readxl)
library(PerformanceAnalytics)
library(tinytex)
NBA_G1_1_ <- read_excel("C:/Users/Luis/Downloads/NBA G1 (1).xlsx")
View(NBA_G1_1_)
df <- NBA_G1_1_
df <- df %>%
  mutate(season_by_period=case_when(
    SEASON %in% c('2014-15', '2015-16', '2016-17', '2017-18', '2018-19', '2019-20', '2020-21', '2021-22', '2022-23') ~ "period 3",
    SEASON %in% c('2005-06', '2006-07', '2007-08', '2008-09', '2009-10', '2010-11', '2011-12', '2012-13', '2013-14') ~ "period 2",
    SEASON %in% c('1996-97', '1997-98', '1998-99', '1999-00', '2000-01', '2001-02', '2002-03', '2003-04', '2004-05') ~ "period 1",
    TRUE ~ "other"
  ))


team_by_period_w_prom <- df %>% group_by(TEAM, season_by_period) %>% summarise(w_prom = mean(W))

w_period_1 <- filter(team_by_period_w_prom, season_by_period == 'period 1')

w_period_1 <- w_period_1[order(w_period_1$w_prom, decreasing = TRUE),]

w_period_1_max <- head(w_period_1, n = 1)
w_period_1_min <- tail(w_period_1, n = 1)


w_period_2 <- filter(team_by_period_w_prom, season_by_period == 'period 2')

w_period_2 <- w_period_2[order(w_period_2$w_prom, decreasing = TRUE),]

w_period_2_max <- head(w_period_2, n = 1)
w_period_2_min <- tail(w_period_2, n = 1)

w_period_3 <- filter(team_by_period_w_prom, season_by_period == 'period 3')

w_period_3 <- w_period_3[order(w_period_3$w_prom, decreasing = TRUE),]

w_period_3_max <- head(w_period_3, n = 1)
w_period_3_min <- tail(w_period_3, n = 1)

#Dataframes de los equipos por períodos con todas las variables#

df_period1 <- df %>% filter(season_by_period=="period 1") %>% filter(TEAM=="Los Angeles Lakers"|TEAM=="Golden State Warriors")
df_period2 <- df %>% filter(season_by_period=="period 2") %>% filter(TEAM=="San Antonio Spurs"|TEAM=="Minnesota Timberwolves")
df_period3<- df %>% filter(season_by_period=="period 3") %>% filter(TEAM==""|TEAM=="Orlando Magic")

```

## Análisis de la defensa de los equipos por períodos:
Se tomaran en los tres períodos las estadísticas defensivas y victorias para compararse entre ellas para ver la relación que tienen.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(gridExtra)
library(knitr)
library(dplyr)
library(readxl)
library(PerformanceAnalytics)

DF_period1_DEFmax <- df_period1 %>% filter(TEAM== "Los Angeles Lakers") %>% select(W,DREB)
corA1 <- chart.Correlation(DF_period1_DEFmax)

###Promedio de bloqueos de equipo con mas victorias de la primera temporada
PromBLKmax1 <- df_period1 %>% filter(TEAM== "Los Angeles Lakers") %>%select(BLK) %>% summarise(mean(BLK))

DF_period1_DEFmin <- df_period1 %>% filter(TEAM== "Golden State Warriors") %>%select(W,DREB)
CorA2 <- chart.Correlation(DF_period1_DEFmin)
###Promedio de bloqueos de equipo con menos de la primera temporada
PromBLKmin1 <- df_period1 %>% filter(TEAM== "Golden State Warriors") %>%select(BLK) %>% summarise(mean(BLK))

### Gráfico de dispersión 
Grperiod1 <- ggplot(df_period1, aes(x=W, y=DREB, color=TEAM)) + geom_point(size=3.0,) + theme_classic() + labs(title= "Victorias vs REBOTES (primer periodo)", x= "WINS", y= "REBOTES")
Grperiod1

 DF_period2_DEFmax <- df_period2 %>% filter(TEAM== "San Antonio Spurs") %>%select(W,DREB) 
CorB1 <- chart.Correlation(DF_period2_DEFmax)
###Promedio de bloqueos de equipo con mas victorias de la segunda temporada
PromBLKmax2 <- df_period2 %>% filter(TEAM== "San Antonio Spurs") %>%select(BLK) %>% summarise(mean(BLK))

DF_period2_DEFmin <- df_period2 %>% filter(TEAM== "Minnesota Timberwolves") %>%select(W,DREB)
CorB2 <- chart.Correlation(DF_period2_DEFmin)
###Promedio de bloqueos de equipo con menos victorias de la segunda temporada
PromBLKmin2 <- df_period2 %>% filter(TEAM== "Minnesota Timberwolves") %>%select(BLK) %>% summarise(mean(BLK))

###Gráficpo de dispersión
Grperiod2 <- ggplot(df_period2, aes(x=W, y=DREB, color=TEAM)) + geom_point(size=3.0,) + theme_classic() + labs(title= "Victorias vs REBOTES (segundo periodo)",x= "WINS", y= "REBOTES")
Grperiod2


DF_period3_DEFmax <- df_period3 %>% filter(TEAM== "Golden State Warriors") %>% select(W,DREB)
CorC1 <- chart.Correlation(DF_period1_DEFmax)
###Promedio de bloqueos de equipo con mas victorias de la tercera temporada
PromBLKmax3  <- df_period3 %>% filter(TEAM== "Golden State Warriors") %>%select(BLK) %>% summarise(mean(BLK))

DF_period3_DEFmin <- df_period3 %>% filter(TEAM== "Orlando Magic") %>%select(W,DREB)
CorC1 <- chart.Correlation(DF_period3_DEFmin)
PromBLKmin3 <- df_period3 %>% filter(TEAM== "Orlando Magic") %>%select(BLK) %>% summarise(mean(BLK))

###Gráfico de dispersión
Grperiod3 <- ggplot(df_period3, aes(x=W, y=DREB, color=TEAM)) + geom_point(size=3.0,) + theme_classic() + labs(title= "Victorias vs REBOTES (tercer periodo)",x= "WINS", y= "REBOTES")
Grperiod3

```

### Primer período

* El primer período se puede ver que tienen una correlación alta las victorias con los rebotes ofensivos,lo cual quiere decir que mientras mas rebotes hacen a lo largo de las temporadas incrementan su cantidad de victorias, mientras que el equipo con menos victorias tiene un correlación inversamente alta, lo que quiere decir que los rebotes bajan las victorias aumentan.
las victorias. 
```{r echo=FALSE, paged.print=FALSE}
plot(Grperiod1)
```

*Por otro lado se sabe que eol equipo con mas victorias tiene un promedio de bloqueos del 5.8 por partido, mientras que el equipo con menos victorias tiene un promedio del 5.1 por partido lo cual no muestra tanta relevancia al respecto

### Segundo Período

* En el segundo período se puede ver que no tienen tanta relación los rebotes con las victorias tanto en el equipo con mas victorias como el que tiene menos victorias,lo que si se puede decir es que el equipo con mas victorias como se ve en el gráfico tiene mayor cantidad de rebotes y es constante con las victorias.

```{r echo=FALSE, paged.print=FALSE}
plot(Grperiod2)
```

*Con respecto a la media de bloqueos por partido del segundo período podemos decir que no hay una relevanacia significativa de una sobre la otra, ya que el equipo con más victorias tiene un promedio de 4.7, mientras que el equipo con menos victorias tiene un promedio de 4.3

### Tercer Período

* En el tercer período el equipo con mas victorias tiene una relación alta con los rebotes, mientras que el equipo con menos victorias tiene una relación casi nula. Se puede ver en los gráficos que el crecimiento de victorias y rebotes es evidente, pero los con el equipo con menos victorias no tiene relevancia juzgarlo por los rebotes.

```{r echo=FALSE, paged.print=FALSE}
plot(Grperiod3)
```

*En el tercer período si se puede decir que hay una diferencia en el promedio de bloqueos por partido, que muestra que si hay beneficios en obtener mas bloqueos ya que el equipo con mas victorias en promedio tiene un aproximado de 5.6 bloqueos por partido, mientras que el equipo con menos victorias tiene un promedio de 4.7

